# CloudWalk Challenge - Level 2.3: Music Generator Company

This repository contains the solution for the "Music Generator Company" challenge. The system is designed as an agent-inspired orchestration architecture responsible for music generation, billing processing, and marketing content creation.

## Architectural Decisions

To ensure the solution is both robust and easy to evaluate in different environments (such as CPU-only CI/CD pipelines), the project is split into two execution modes:

1.  **`main.py` (Architectural Showcase):**
    * Focus: Validates the orchestration logic, agent interaction, file I/O, and playlist generation.
    * Mechanism: Uses a mocked music generation step that produces non-empty dummy .wav files to exercise the full pipeline.
    * Performance: Runs instantly. Ideal for checking the workflow logic without hardware constraints.

2.  **`real_music.py` (Real AI Inference):**
    * Focus: Demonstrates the actual implementation of Generative AI for music creation.
    * Mechanism: Uses Meta's MusicGen Small model via Hugging Face `transformers`.
    * Performance: Optimized for CPU execution by constraining generation length; typically requires ~2–3 minutes per track.

## File Structure

* `main.py`: Entry point for the logic/mock demonstration.
* `real_music.py`: Implementation using a real deep learning model (`facebook/musicgen-small`).
* `requirements.txt`: Python dependencies required only for the Real AI mode.
* `billing_ledger.json`: Automatically generated log of transactions.
* `cloudwalk_playlist.m3u`: Final playlist file generated by the system.

## Setup & Installation

Ensure you have Python 3.8+ installed.

1.  Install Dependencies:
    (Required only for `real_music.py`)
    ```bash
    pip install -r requirements.txt
    ```

## How to Run

### Option A: Logic & Architecture Test (Recommended First)
Run the main script to validate agent orchestration, billing logic, file validation, and playlist generation.

```bash
python main.py
```

Output: Creates dummy .wav files, updates billing_ledger.json, and generates cloudwalk_playlist.m3u.

### Option B: Real AI Generation (MusicGen)

```bash
python real_music.py
```

Note: On a standard CPU, generation may take 2–3 minutes per track. The code constrains generation length via max_new_tokens=256 (as exposed by the MusicGen transformers interface) to prevent excessive runtimes.

## Key features: 

* The system filters out invalid or empty audio files based on file size validation (os.path.getsize), ensuring the .m3u playlist only contains playable tracks. 
* The AI inference is wrapped in try/except blocks to ensure the pipeline continues even if the model fails to load. 
* Distinct methods for Billing, Music, and Marketing to simulate a microservices-like architecture.